---
title: "p8105_hw3_mfc2162"
author: "Madeline Cannon"
date: "10/9/2019"
output: github_document
---

## Problem 1

#### Load data

```{r}

library(tidyverse)
library(p8105.datasets)
data("instacart")

```

There are `r nrow(instacart)` observations and `r ncol(instacart)` variables in this dataset. Each observation is a product that was ordered. Some key variables are the hour of the day at which the product was ordered, the number of days since the last order, the name of the product, and the aisle and department that it is in. An example of an observation is Bulgarian yogurt, which was part of order 1, ordered at 10:00, and from the dairy and eggs department.


#### Aisle description

```{r}

aisles = instacart %>% count(aisle)
max_aisle = aisles %>% filter(n == max(pull(aisles, n)))

```

There are `r nrow(aisles)` different aisles. The `r pull(max_aisle, aisle)` aisle had the most items ordered from it.


#### Aisle plot

```{r}

aisles_over_10000 = aisles %>% filter(n > 10000)

aisle_plot <- ggplot(data=aisles_over_10000, aes(x=reorder(aisle, n), y=n)) +
  geom_bar(stat="identity") + xlab("Aisle") + ylab("Number of items ordered") +
  coord_flip(xlim = NULL, ylim = NULL, expand = TRUE, clip = "on")

aisle_plot

```


#### Baking ingredients, dog food/care, and packaged vegetables/fruits table

```{r}

three_aisles = instacart %>%
                filter(aisle == "baking ingredients" |
                         aisle == "dog food care" |
                         aisle == "packaged vegetables fruits") %>%
                group_by(aisle, product_name) %>%
                summarize(n_obs = n()) %>%
                filter(min_rank(desc(n_obs)) < 4)

three_aisles

```


#### Mean hour table

```{r}

mean_hour_table = instacart %>%
                    filter(product_name == "Pink Lady Apples" |
                             product_name == "Coffee Ice Cream") %>%
                    group_by(product_name, order_dow) %>%
                    summarize(mean_hour = mean(order_hour_of_day)) %>%
                    pivot_wider(names_from = "product_name",
                                values_from = "mean_hour") %>%
                    mutate(order_dow = c("Sunday", "Monday", "Tuesday",
                                         "Wednesday", "Thursday", "Friday",
                                         "Saturday"))

names(mean_hour_table) = c("Day of the Week", "Pink Lady Apples", "Coffee Ice Cream")

mean_hour_table

```

## Problem 2

#### Load data

```{r}

data("brfss_smart2010")

```


#### Clean data

```{r}

brfss = brfss_smart2010 %>%
        janitor::clean_names() %>%
        filter(topic == "Overall Health") %>%
        mutate(response = factor(response, levels = str_c(c("Poor",
                                                            "Fair",
                                                            "Good",
                                                            "Very good",
                                                            "Excellent"))))

```